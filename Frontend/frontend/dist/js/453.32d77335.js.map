{"version":3,"file":"js/453.32d77335.js","mappings":"utDA0FI,MAAMA,GAAUC,EAAAA,EAAAA,IAAI,IACdC,GAAWD,EAAAA,EAAAA,IAAI,MAEfE,GAASC,EAAAA,EAAAA,MACTC,EAAcF,EAAOG,aAAaC,MAAMC,OAAOC,UAErD,SAASC,EAAeC,GACpB,MAAMC,EAAQD,EAAME,OAAOD,MAAM,GACjCV,EAASK,MAAQK,CACrB,CAEA,SAASE,IACAZ,EAASK,QAIdQ,EAAAA,EAAAA,IAAcV,EAAaH,EAASK,OACpCP,EAAQO,MAAQ,OAChBJ,EAAOa,KAAK,YAAcX,EAAc,aALpCL,EAAQO,MAAQ,MAMxB,CAEA,SAASU,IACLf,EAASK,MAAQ,IACrB,C,2wBC9GJ,MAAMW,EAAc,EAEpB,O","sources":["webpack://pms/./src/components/Student/ImportView.vue","webpack://pms/./src/components/Student/ImportView.vue?bb03"],"sourcesContent":["<template>\r\n    <div>\r\n        <div class=\"card shadow\">\r\n            <div class=\"card-header py-3\">\r\n                <p class=\"text-primary m-0 fw-bold\" style=\"font-size: 28px;\">{{ $route.name }}</p>\r\n            </div>\r\n            <div class=\"card-body mh-100\">\r\n                <div class=\"alert alert-success\" role=\"alert\"><span><strong>從Excel導入前請仔細閱讀說明</strong><br></span></div>\r\n                <div class=\"row\">\r\n                    <div>\r\n                        <ul class=\"list-group list-group-numbered mb-3\">\r\n                            <li class=\"list-group-item w-100\"><span>文件格式必須為 .xls 或 .xlsx</span></li>\r\n                            <li class=\"list-group-item\"><span>第一行將不會被導入</span></li>\r\n                            <li class=\"list-group-item\"><span>格順序應如下所示 </span><span class=\"bg-warning\">學號 (大寫), 姓名, 班級, 類型,\r\n                                    科系ID, 科系, 學院ID, 學院<br></span></li>\r\n                            <li class=\"list-group-item\"><span>學號必須包含在內，否則數據將不會導入</span></li>\r\n                            <li class=\"list-group-item\"><span>學號不應重複</span></li>\r\n                            <li class=\"list-group-item\"><span>示例提供如下</span></li>\r\n                        </ul>\r\n                        <div class=\"table-responsive\">\r\n                            <table class=\"table\">\r\n                                <thead>\r\n                                    <tr>\r\n                                        <th>學號<br></th>\r\n                                        <th>姓名<br></th>\r\n                                        <th>班級<br></th>\r\n                                        <th>類型<br></th>\r\n                                        <th>科系ID<br></th>\r\n                                        <th>科系<br></th>\r\n                                        <th>學院ID<br></th>\r\n                                        <th>學院<br></th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                    <tr>\r\n                                        <td>D1234567</td>\r\n                                        <td>陳小明</td>\r\n                                        <td>人工智慧技術與應用學士學位學程一</td>\r\n                                        <td>學生</td>\r\n                                        <td>AITI</td>\r\n                                        <td>人工智慧技術與應用學士學位學程<br></td>\r\n                                        <td>AITI</td>\r\n                                        <td>創能學院</td>\r\n                                    </tr>\r\n                                    <tr></tr>\r\n                                    <tr>\r\n                                        <td>T1234567</td>\r\n                                        <td>陳大明</td>\r\n                                        <td>人工智慧技術與應用學士學位學程一</td>\r\n                                        <td>教師</td>\r\n                                        <td>AITI</td>\r\n                                        <td>人工智慧技術與應用學士學位學程<br></td>\r\n                                        <td>AITI</td>\r\n                                        <td>創能學院</td>\r\n                                    </tr>\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                        <form>\r\n                            <div class=\"row\">\r\n                                <div class=\"col\" style=\"text-align: right;\">\r\n                                    <input class=\"form-control shadow-none\" type=\"file\"\r\n                                        accept=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel\"\r\n                                        @change=\"onFileSelected\">\r\n                                    <br>\r\n                                    <button class=\"btn btn-primary btn-info shadow-none\" type=\"button\" @click=\"clearAll\">\r\n                                        <i class=\"fa fa-remove\">\r\n                                        </i>&nbsp;清除\r\n                                    </button>\r\n                                    <button class=\"btn btn-primary shadow-none\" type=\"button\" @click=\"upload\">\r\n                                        <i class=\"fa fa-upload\">\r\n                                        </i>\r\n                                        &nbsp;上傳\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <AlertBlock :message=\"message\" @closeBlock=\"message = ``\" />\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\n    import { importStudent } from \"@/assets/js/helper.js\"\r\n    import { useRouter } from \"vue-router\"\r\n    import { ref } from \"vue\"\r\n\r\n    const message = ref(\"\")\r\n    const fileList = ref(null)\r\n\r\n    const router = useRouter()\r\n    const projectUUID = router.currentRoute.value.params.projectID\r\n\r\n    function onFileSelected(event) {\r\n        const files = event.target.files[0]\r\n        fileList.value = files\r\n    }\r\n\r\n    function upload() {\r\n        if (!fileList.value) {\r\n            message.value = \"沒有檔案\"\r\n            return\r\n        }\r\n        importStudent(projectUUID, fileList.value);\r\n        message.value = \"導入成功\"\r\n        router.push(\"/project/\" + projectUUID + \"/student\")\r\n    }\r\n\r\n    function clearAll() {\r\n        fileList.value = null\r\n    }\r\n</script>","import script from \"./ImportView.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ImportView.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["message","ref","fileList","router","useRouter","projectUUID","currentRoute","value","params","projectID","onFileSelected","event","files","target","upload","importStudent","push","clearAll","__exports__"],"sourceRoot":""}