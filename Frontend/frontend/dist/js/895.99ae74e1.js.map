{"version":3,"file":"js/895.99ae74e1.js","mappings":"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","sources":["webpack://pms/./src/components/Assignment/InfoView.vue","webpack://pms/./src/components/Assignment/InfoView.vue?21e7","webpack://pms/./src/components/Assignment/SubmitView.vue","webpack://pms/./src/components/Assignment/SubmitView.vue?50e9"],"sourcesContent":["<template>\r\n    <div>\r\n        <div class=\"card shadow mb-3\">\r\n            <div class=\"card-header py-3\">\r\n                <div class=\"row\">\r\n                    <div class=\"col-md-6 text-nowrap\">\r\n                        <p class=\"text-primary m-0 fw-bold\" style=\"font-size: 28px;\">{{ $route.name }}</p>\r\n                    </div>\r\n                    <div class=\"col-md-6 text-md-end dataTables_filter mt-1\">\r\n                        <div class=\"btn-group\" role=\"group\">\r\n                            <button @click=\"markScore\" class=\"btn btn-primary btn-sm d-none d-sm-inline-block shadow-none\" role=\"button\">\r\n                                <i class=\"icon ion-clipboard\"></i>\r\n                                評分\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"card-body\">\r\n                <div class=\"col\">\r\n                    <div class=\"row\">\r\n                        <div class=\"col col-4 justify-content-center\">\r\n                            <p style=\"font-size: 24px;padding-left: 10px;\">名稱</p>\r\n                        </div>\r\n                        <div class=\"col\">\r\n                            <p style=\"font-size: 24px;color: rgb(38,38,38);\">{{ name }}</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"row\">\r\n                        <div class=\"col col-4 justify-content-center\">\r\n                            <p style=\"font-size: 24px;padding-left: 10px;\">小組</p>\r\n                        </div>\r\n                        <div class=\"col\">\r\n                            <p style=\"font-size: 24px;color: rgb(38,38,38);\">{{ group }}</p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class=\"row\">\r\n                        <div class=\"col col-4 justify-content-center\">\r\n                            <p style=\"font-size: 24px;padding-left: 10px;\">分數</p>\r\n                        </div>\r\n                        <div class=\"col\">\r\n                            <p style=\"font-size: 24px;color: rgb(38,38,38);\">{{ mark }}</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"row\">\r\n                        <div class=\"col col-4 justify-content-center\">\r\n                            <p style=\"font-size: 24px;padding-left: 10px;\">權重</p>\r\n                        </div>\r\n                        <div class=\"col\">\r\n                            <p style=\"font-size: 24px;color: rgb(38,38,38);\">{{ weight }}</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"row\">\r\n                        <div class=\"col col-4 justify-content-center\">\r\n                            <p style=\"font-size: 24px;padding-left: 10px;\">繳交日期</p>\r\n                        </div>\r\n                        <div class=\"col\">\r\n                            <p style=\"font-size: 24px;color: rgb(38,38,38);\">{{ date }}</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"card shadow\">\r\n            <div class=\"card-header py-3\">\r\n                <p class=\"text-primary m-0 fw-bold\" style=\"font-size: 28px;\">作業文件</p>\r\n            </div>\r\n            <div class=\"card-body\">\r\n                <div class=\"col\">\r\n                    <EasyDataTable v-if=\"name\" :headers=\"headers\" :items=\"items\" table-class-name=\"customize-table\" show-index alternating>\r\n                        <template #item-title=\"item\">\r\n                            <a :href=\"`/download/${item.taskID}/${item.fileID}/${item.filename}`\" @click=\"download(item)\" @click.prevent=\"\" :download=\"item.filename\">{{ item.filename }} </a>\r\n                        </template>\r\n\r\n                        <template #item-operation=\"item\">\r\n                            <div class=\"btn-group\" role=\"group\">\r\n                                <button class=\"btn btn-primary shadow-none\" style=\"background: #e74a3b;width: 42px;\" @click=\"deleteItem(item)\">\r\n                                    <i class=\"icon ion-android-delete\"></i>\r\n                                </button>\r\n                            </div>\r\n                        </template>\r\n                    </EasyDataTable>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <SubmitView v-if=\"allowedFileTypes && assignmentStatus==`已評分`\" :allowedFileTypes=\"allowedFileTypes\" />\r\n        <AlertBlock :message=\"message\" @closeBlock=\"message=``\" />\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\n    import { deleteAssignmentItem } from \"@/assets/js/helper.js\"\r\n    import { markAssignmentScore } from \"@/assets/js/helper.js\"\r\n    import { downloadAssignment } from \"@/assets/js/helper.js\"\r\n    import { getAssignmentInfo } from \"@/assets/js/helper.js\"\r\n    import SubmitView from \"./SubmitView.vue\"\r\n    import { useRouter } from \"vue-router\"\r\n    import { onMounted } from \"vue\"\r\n    import { ref } from \"vue\"\r\n\r\n    const allowedFileTypes = ref(\"\")\r\n    const assignmentStatus = ref(\"\")\r\n    const message = ref(\"\")\r\n    const weight = ref(\"\")\r\n    const group = ref(\"\")\r\n    const mark = ref(\"\")\r\n    const name = ref(\"\")\r\n    const date = ref(\"\")\r\n\r\n    const router = useRouter()\r\n    const projectUUID = router.currentRoute.value.params.projectID\r\n    const assignmentUUID = router.currentRoute.value.params.assignmentID\r\n\r\n    const items = ref([])\r\n    const headers = [\r\n        {\r\n            text: \"檔案名稱\",\r\n            value: \"title\",\r\n            sortable: true,\r\n        },\r\n        {\r\n            text: \"上傳者\",\r\n            value: \"author\",\r\n            sortable: true,\r\n        },\r\n        {\r\n            text: \"上載日期\",\r\n            value: \"date\",\r\n            sortable: true,\r\n        },\r\n        {\r\n            text: \"選項\",\r\n            value: \"operation\",\r\n        },\r\n    ]\r\n\r\n    onMounted(async () => {\r\n        const info = await getAssignmentInfo(projectUUID, assignmentUUID)\r\n        if (info.status_code) {\r\n            return\r\n        }\r\n        name.value = info.assignment_name\r\n        group.value = info.group_name\r\n        mark.value = info.mark\r\n        weight.value = info.weight\r\n        date.value = info.date.replace(\"T\", \" \")\r\n        allowedFileTypes.value = info.allowedFileTypes\r\n        assignmentStatus.value = info.state\r\n\r\n        if (!info.assignment_file){\r\n            info.assignment_file = []\r\n        }\r\n        items.value = info.assignment_file\r\n    })\r\n\r\n    function markScore() {\r\n        const marks = parseInt(prompt(\"分數\",\"0-100\"))\r\n        if (!marks) {\r\n            MessageChannel.value = \"輸入錯誤\"\r\n            return\r\n        }\r\n        if (marks <= 0 || marks > 100) {\r\n            message.value = \"輸入錯誤\"\r\n            return\r\n        }\r\n        if (confirm(\"提交分數後學生不能再提交作業\\n是否確定?\")) {\r\n            markAssignmentScore(assignmentUUID, projectUUID, marks)\r\n            mark.value = marks\r\n            message.value = \"提交成功\"\r\n        }\r\n    }\r\n\r\n    async function download(item) {\r\n        const fileExtension = item.filename.split(\".\").pop();\r\n\r\n        let fileData = await downloadAssignment(projectUUID, item.taskID, item.fileID, item.filename)\r\n        const resultUrl = URL.createObjectURL(new Blob([fileData], {type: `application/${fileExtension}`}));\r\n\r\n        const a = document.createElement(\"a\");\r\n        a.href = resultUrl;\r\n        a.download = item.filename;\r\n        a.style.display = \"none\"\r\n        document.body.appendChild(a);\r\n\r\n        a.click();\r\n        a.remove();\r\n    }\r\n\r\n    function deleteItem(item) {\r\n        if (!confirm(\"確定刪除項目？\")) {\r\n            return\r\n        }\r\n        items.value.splice(item.index-1, 1)\r\n\r\n        deleteAssignmentItem(item.taskID, item.fileID, item.author)\r\n    }\r\n</script>","import script from \"./InfoView.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./InfoView.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\r\n    <div\r\n    @dragover.prevent\r\n    @dragenter.prevent\r\n    @dragleave.prevent\r\n    @drop=\"handleDrop\">\r\n    <div class=\"card shadow my-3\">\r\n        <div class=\"card-header py-3\">\r\n            <p class=\"text-primary m-0 fw-bold\" style=\"font-size: 28px;\">上載檔案</p>\r\n        </div>\r\n        <div class=\"card-body\">\r\n            <div class=\"row\">\r\n                <div class=\"col\">\r\n                        <div class=\"row\">\r\n                            <div class=\"col col-4\">\r\n                                <p style=\"font-size: 24px;\">作業文件</p>\r\n                            </div>\r\n                            <div class=\"col\">\r\n                                <input class=\"form-control shadow-none\" type=\"file\" @change=\"onFileSelected\" multiple :accept=\"allowedFormat\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <br />\r\n                <div class=\"col\">\r\n                    <EasyDataTable\r\n                    :headers=\"headers\"\r\n                    :items=\"fileList\"\r\n                    table-class-name=\"customize-table\"\r\n                    show-index  alternating />\r\n                </div>\r\n                <br>\r\n                <div class=\"row\">\r\n                    <div class=\"col\" style=\"text-align: left;\">\r\n                        <div>\r\n                            <label>您可以將文件拖放到此處</label>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"col\" style=\"text-align: right;\">\r\n                        <button class=\"btn btn-primary shadow-none\" type=\"button\" @click=\"submitAssignment\">\r\n                            <i class=\"icon ion-android-upload\"></i>上載\r\n                        </button>\r\n                        <button class=\"btn btn-primary shadow-none mx-1\" type=\"button\" @click=\"deleteAll\">\r\n                            <i class=\"icon ion-android-delete\"></i>清除所有\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\n    import { uploadAssignment } from \"@/assets/js/helper.js\"\r\n    import { useRouter } from \"vue-router\"\r\n    import { ref } from \"vue\"\r\n\r\n    let props = defineProps({\r\n        allowedFileTypes: String\r\n    })\r\n\r\n    const allowedFormat = ref(props.allowedFileTypes)\r\n    console.log(props.allowedFileTypes)\r\n\r\n    const fileList = ref([])\r\n    const headers = ref([\r\n        {\r\n            text: \"作業\",\r\n            value: \"name\",\r\n            sortable: true\r\n        },\r\n    ])\r\n\r\n    const router = useRouter()\r\n    const projectUUID = router.currentRoute.value.params.projectID\r\n    const assignmentUUID = router.currentRoute.value.params.assignmentID\r\n\r\n    function onFileSelected(event) {\r\n        const files = event.target.files\r\n        for (const i of files) {\r\n            fileList.value.push({\r\n                \"name\": i.name,\r\n                \"file\": i,\r\n            })\r\n        }\r\n    }\r\n\r\n    function deleteAll() {\r\n        fileList.value = []\r\n    }\r\n\r\n    function handleDrop(event) {\r\n        event.preventDefault();\r\n        const files = event.dataTransfer.files;\r\n\r\n        processDroppedFiles(files);\r\n    }\r\n\r\n    function processDroppedFiles(files) {\r\n        for (const i of files) {\r\n            fileList.value.push({\r\n                \"name\": i.name,\r\n                \"file\": i,\r\n            })\r\n        }\r\n    }\r\n\r\n    function submitAssignment() {\r\n        for (const i of fileList.value) {\r\n            uploadAssignment(projectUUID, assignmentUUID, i.name, i.file)\r\n        }\r\n        router.push(`/project/${projectUUID}/assignment`)\r\n    }\r\n</script>","import script from \"./SubmitView.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./SubmitView.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["allowedFileTypes","ref","assignmentStatus","message","weight","group","mark","name","date","router","useRouter","projectUUID","currentRoute","value","params","projectID","assignmentUUID","assignmentID","items","headers","text","sortable","markScore","marks","parseInt","prompt","confirm","markAssignmentScore","MessageChannel","async","download","item","fileExtension","filename","split","pop","fileData","downloadAssignment","taskID","fileID","resultUrl","URL","createObjectURL","Blob","type","a","document","createElement","href","style","display","body","appendChild","click","remove","deleteItem","splice","index","deleteAssignmentItem","author","onMounted","info","getAssignmentInfo","status_code","assignment_name","group_name","replace","state","assignment_file","__exports__","props","__props","allowedFormat","console","log","fileList","onFileSelected","event","files","target","i","push","deleteAll","handleDrop","preventDefault","dataTransfer","processDroppedFiles","submitAssignment","uploadAssignment","file"],"sourceRoot":""}