{"version":3,"file":"js/707.958f4fcb.js","mappings":"6hDAwHI,MAAMA,GAASC,EAAAA,EAAAA,MACTC,EAAcF,EAAOG,aAAaC,MAAMC,OAAOC,UAC/CC,GAAYC,EAAAA,EAAAA,IAAI,IAChBC,GAAUD,EAAAA,EAAAA,IAAI,IAEdE,GAAqBF,EAAAA,EAAAA,IAAI,IACzBG,GAAqBH,EAAAA,EAAAA,IAAI,IAEzBI,GAAkBJ,EAAAA,EAAAA,IAAI,IACtBK,GAAkBL,EAAAA,EAAAA,IAAI,IAEtBM,GAAeN,EAAAA,EAAAA,IAAI,IACnBO,GAAeP,EAAAA,EAAAA,IAAI,IAEnBQ,EAAU,CACZ,CACIC,KAAM,MACNb,MAAO,MACPc,UAAU,GAEd,CACID,KAAM,KACNb,MAAO,OACPc,UAAU,IAIZC,GAA2BX,EAAAA,EAAAA,IAAI,IAC/BY,GAA2BZ,EAAAA,EAAAA,IAAI,IAiBrCa,eAAeC,IACX,GAAIC,KAAKC,MAAMD,KAAKE,UAAUZ,EAAgBT,SAAW,GAErD,YADAK,EAAQL,MAAQ,cAGpB,IAAKG,EAAUH,MAEX,YADAK,EAAQL,MAAQ,UAGpB,MAAMsB,QAAYC,EAAAA,EAAAA,MAClB,IAAK,MAAMC,KAAKhB,EAAgBR,MAAO,CACnC,MAAMyB,QAAeC,EAAAA,EAAAA,IAAS5B,EAAa0B,EAAEG,IAAKxB,EAAUH,MAAOsB,EAAIA,KACvE,GAA0B,KAAtBG,EAAOG,YAEP,YADAvB,EAAQL,MAAQ,sBAAwByB,EAAO,qBAGvD,CACA,IAAK,MAAMD,KAAKf,EAAgBT,MAAO,CACnC,MAAMyB,QAAeC,EAAAA,EAAAA,IAAS5B,EAAa0B,EAAEG,IAAKxB,EAAUH,MAAOsB,EAAIA,KACvE,GAA0B,KAAtBG,EAAOG,YAEP,YADAvB,EAAQL,MAAQ,sBAAwByB,EAAO,qBAGvD,CACA7B,EAAOiC,IAAI,EACf,C,OAxCAC,EAAAA,EAAAA,KAAUb,UACN,MAAMc,QAAoBC,EAAAA,EAAAA,IAAoBlC,GACxCmC,QAAoBC,EAAAA,EAAAA,IAAoBpC,GACzCqC,MAAMC,QAAQL,IAGdI,MAAMC,QAAQH,KAInBvB,EAAaV,MAAQ+B,EACrBpB,EAAaX,MAAQiC,EAAW,I,49EC9JxC,MAAMI,EAAc,EAEpB,O","sources":["webpack://pms/./src/components/Group/NewView.vue","webpack://pms/./src/components/Group/NewView.vue?56cd"],"sourcesContent":["<template>\r\n    <div>\r\n        <div class=\"card shadow my-3\">\r\n            <div class=\"card-header py-3\">\r\n                <div class=\"row\">\r\n                    <div class=\"col-md-6 text-nowrap\">\r\n                        <p class=\"text-primary m-0 fw-bold\" style=\"font-size: 28px;\">{{ $route.name }}</p>\r\n                    </div>\r\n                    <div class=\"col-md-6 text-md-end dataTables_filter mt-1\">\r\n                        <div class=\"btn-group\" role=\"group\">\r\n                            <button class=\"btn btn-primary btn-sm d-none d-sm-inline-block shadow-none\" role=\"button\" @click=\"saveGroup\">\r\n                                <i class=\"fas fa-save fa-sm text-white-50\"></i> 儲存\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n            <div class=\"card-body mh-100\">\r\n                <div class=\"row\">\r\n                    <div class=\"col col-4\">\r\n                        <p style=\"font-size: 24px;\">小組名稱</p>\r\n                    </div>\r\n                    <div class=\"col\">\r\n                        <input class=\"form-control w-100 shadow-none\" :class=\"!groupName ? 'alert-danger border-danger': ''\" type=\"text\" v-model=\"groupName\">\r\n                        <span :style=\"groupName ? 'visibility:hidden': ''\" class=\"tooltiptext\">*必需項目</span>\r\n                    </div>\r\n                </div>\r\n                <hr>\r\n                <div>\r\n                    <div class=\"row\">\r\n                        <div class=\"col\">\r\n                            <div class=\"col text-center align-middle\">\r\n                                <p class=\"lead\" style=\"font-size: 24px;\">可選擇教授</p>\r\n                            </div>\r\n                            <div class=\"col text-center align-middle\">\r\n                                <input type=\"text\" class=\"form-control shadow-none\" v-model=\"teacherSearchValue\" placeholder=\"搜尋\">\r\n                            </div>\r\n                            <br>\r\n                            <EasyDataTable\r\n                                :headers=\"Headers\"\r\n                                :items=\"teacherItems\"\r\n                                v-model:items-selected=\"teacherSelected\"\r\n                                show-index\r\n                                :search-value=\"teacherSearchValue\"\r\n                                alternating\r\n                            >\r\n                        </EasyDataTable>\r\n                    </div>\r\n                        <div class=\"col\">\r\n                            <div class=\"col text-center align-middle\">\r\n                                <p class=\"lead\" style=\"font-size: 24px;\">已選教授</p>\r\n                            </div>\r\n                            <div class=\"col text-center align-middle\">\r\n                                <input type=\"text\" class=\"form-control shadow-none\" v-model=\"teacherSelectSearchValue\" placeholder=\"搜尋\">\r\n                            </div>\r\n                            <br>\r\n                            <EasyDataTable\r\n                                :headers=\"Headers\"\r\n                                :items=\"teacherSelected\"\r\n                                show-index\r\n                                :search-value=\"teacherSelectSearchValue\"\r\n                                alternating>\r\n                            </EasyDataTable>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <br>\r\n                <div>\r\n                    <div class=\"row\">\r\n                        <div class=\"col\">\r\n                            <div class=\"col text-center align-middle\">\r\n                                <p class=\"lead\" style=\"font-size: 24px;\">可選擇學生</p>\r\n                            </div>\r\n                            <div class=\"col text-center align-middle\">\r\n                                <input type=\"text\" class=\"form-control shadow-none\" v-model=\"studentSearchValue\" placeholder=\"搜尋\">\r\n                            </div>\r\n                            <br>\r\n                            <EasyDataTable\r\n                                :headers=\"Headers\"\r\n                                :items=\"studentItems\"\r\n                                v-model:items-selected=\"studentSelected\"\r\n                                show-index\r\n                                :search-value=\"studentSearchValue\"\r\n                                alternating>\r\n                            </EasyDataTable>\r\n                        </div>\r\n\r\n                        <div class=\"col\">\r\n                            <div class=\"col text-center align-middle\">\r\n                                <p class=\"lead\" style=\"font-size: 24px;\">已選學生</p>\r\n                            </div>\r\n                            <div class=\"col text-center align-middle\">\r\n                                <input type=\"text\" class=\"form-control shadow-none\" v-model=\"studentSelectSearchValue\" placeholder=\"搜尋\">\r\n                            </div>\r\n                            <br>\r\n                            <EasyDataTable\r\n                                :headers=\"Headers\"\r\n                                :items=\"studentSelected\"\r\n                                show-index\r\n                                :search-value=\"studentSelectSearchValue\" alternating>\r\n                            </EasyDataTable>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <AlertBlock :message=\"message\" @closeBlock=\"message=``\" />\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\n    import { getGroupTeacherData } from \"@/assets/js/helper.js\"\r\n    import { getGroupStudentData } from \"@/assets/js/helper.js\"\r\n    import { getGroupToken } from \"@/assets/js/helper.js\"\r\n    import { newGroup } from \"@/assets/js/helper.js\"\r\n    import { useRouter } from \"vue-router\"\r\n    import { onMounted } from \"vue\"\r\n    import { ref } from \"vue\"\r\n\r\n    const router = useRouter()\r\n    const projectUUID = router.currentRoute.value.params.projectID\r\n    const groupName = ref(\"\")\r\n    const message = ref(\"\")\r\n\r\n    const teacherSearchValue = ref(\"\")\r\n    const studentSearchValue = ref(\"\")\r\n\r\n    const teacherSelected = ref([]);\r\n    const studentSelected = ref([]);\r\n\r\n    const teacherItems = ref([])\r\n    const studentItems = ref([]);\r\n\r\n    const Headers = [\r\n        {\r\n            text: \"NID\",\r\n            value: \"nid\",\r\n            sortable: true,\r\n        },\r\n        {\r\n            text: \"姓名\",\r\n            value: \"name\",\r\n            sortable: true,\r\n        },\r\n    ];\r\n\r\n    const teacherSelectSearchValue = ref(\"\")\r\n    const studentSelectSearchValue = ref(\"\")\r\n\r\n    onMounted(async () => {\r\n        const teacherList = await getGroupTeacherData(projectUUID)\r\n        const studentList = await getGroupStudentData(projectUUID)\r\n        if (!Array.isArray(teacherList)) {\r\n            return\r\n        }\r\n        if (!Array.isArray(studentList)) {\r\n            return\r\n        }\r\n\r\n        teacherItems.value = teacherList\r\n        studentItems.value = studentList\r\n    })\r\n\r\n\r\n    async function saveGroup() {\r\n        if (JSON.parse(JSON.stringify(studentSelected.value)) == []) {\r\n            message.value = \"必須選擇至少一名學生\"\r\n            return\r\n        }\r\n        if (!groupName.value) {\r\n            message.value = \"沒有組別名稱\"\r\n            return\r\n        }\r\n        const GID = await getGroupToken()\r\n        for (const i of teacherSelected.value) {\r\n            const status = await newGroup(projectUUID, i.nid, groupName.value, GID.GID)\r\n            if (status.status_code == 400) {\r\n                message.value = \"SQLInjectionCheck: \" + status[\"SQLInjectionCheck\"]\r\n                return\r\n            }\r\n        }\r\n        for (const i of studentSelected.value) {\r\n            const status = await newGroup(projectUUID, i.nid, groupName.value, GID.GID)\r\n            if (status.status_code == 400) {\r\n                message.value = \"SQLInjectionCheck: \" + status[\"SQLInjectionCheck\"]\r\n                return\r\n            }\r\n        }\r\n        router.go(-1)\r\n    }\r\n</script>","import script from \"./NewView.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./NewView.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["router","useRouter","projectUUID","currentRoute","value","params","projectID","groupName","ref","message","teacherSearchValue","studentSearchValue","teacherSelected","studentSelected","teacherItems","studentItems","Headers","text","sortable","teacherSelectSearchValue","studentSelectSearchValue","async","saveGroup","JSON","parse","stringify","GID","getGroupToken","i","status","newGroup","nid","status_code","go","onMounted","teacherList","getGroupTeacherData","studentList","getGroupStudentData","Array","isArray","__exports__"],"sourceRoot":""}