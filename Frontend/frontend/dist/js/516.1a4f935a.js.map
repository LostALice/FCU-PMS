{"version":3,"file":"js/516.1a4f935a.js","mappings":"+lDAkFI,MAAMA,GAASC,EAAAA,EAAAA,MACTC,GAAUC,EAAAA,EAAAA,IAAI,IACdC,GAAWD,EAAAA,EAAAA,IAAI,MAarB,SAASE,EAAeC,GACpB,MAAMC,EAAQD,EAAME,OAAOD,MAAM,GACjCH,EAASK,MAAQF,CACrB,CAEAG,eAAeC,IACX,IAAKP,EAASK,MAEV,YADAP,EAAQO,MAAQ,QAGpB,MAAMG,QAAeC,EAAAA,EAAAA,IAAWT,EAASK,OACZ,KAAzBG,EAAO,eAIXV,EAAQO,MAAQ,OAHZP,EAAQO,MAAQ,UAAYG,EAAO,eAAiB,IAAMA,EAAO,UAIzE,CAEA,SAASE,IACLV,EAASK,MAAQ,IACrB,C,OA/BAM,EAAAA,EAAAA,KAAUL,UAGN,GAFAR,EAAQO,MAAQ,oEAEkB,SAAxBO,EAAAA,EAAAA,MAIN,OAHAd,EAAQO,MAAQ,qBAChBT,EAAOiB,QAAQ,mBACfC,QAAQC,IAAI,KAEhB,I,qwBC3FR,MAAMC,EAAc,EAEpB,O","sources":["webpack://pms/./src/components/Administration/ImportView.vue","webpack://pms/./src/components/Administration/ImportView.vue?b5f5"],"sourcesContent":["<template>\r\n    <div>\r\n        <div class=\"card shadow\">\r\n            <div class=\"card-header py-3\">\r\n                <p class=\"text-primary m-0 fw-bold\" style=\"font-size: 28px\">{{$route.name}}</p>\r\n            </div>\r\n            <div class=\"card-body mh-100\">\r\n                <div class=\"alert alert-success\" role=\"alert\"><span><strong>從Excel導入前請仔細閱讀說明</strong><br></span></div>\r\n                <div class=\"row\">\r\n                    <div>\r\n                        <ul class=\"list-group list-group-numbered mb-3\">\r\n                            <li class=\"list-group-item w-100\"><span>文件格式必須為 .xls 或 .xlsx</span></li>\r\n                            <li class=\"list-group-item\"><span>第一行將不會被導入</span></li>\r\n                            <li class=\"list-group-item\"><span>格順序應如下所示 </span><span class=\"bg-warning\">學號 (大寫), 姓名, 密碼, 電郵地址(可選)</span></li>\r\n                            <li class=\"list-group-item\"><span>學號</span></li>\r\n                            <li class=\"list-group-item\"><span>密碼至少8個字元以上</span></li>\r\n                            <li class=\"list-group-item\"><span>學號不應重複</span></li>\r\n                            <li class=\"list-group-item\"><span>示例提供如下</span></li>\r\n                        </ul>\r\n                        <div class=\"table-responsive\">\r\n                            <table class=\"table\">\r\n                                <thead>\r\n                                    <tr>\r\n                                        <th>學號<br></th>\r\n                                        <th>USERNAME<br></th>\r\n                                        <th>PASSWORD<br></th>\r\n                                        <th>EMAIL<br></th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                    <tr>\r\n                                        <td>D1234567</td>\r\n                                        <td>陳小明</td>\r\n                                        <td>may be this is a password</td>\r\n                                        <td><i>null</i></td>\r\n                                    </tr>\r\n                                    <tr></tr>\r\n                                    <tr>\r\n                                        <td>T1234567</td>\r\n                                        <td>陳大明</td>\r\n                                        <td>this string can be a password</td>\r\n                                        <td>example@example.com</td>\r\n                                    </tr>\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                        <form>\r\n                            <div class=\"row\">\r\n                                <div class=\"col\" style=\"text-align: right\">\r\n                                    <input\r\n                                        class=\"form-control shadow-none\"\r\n                                        type=\"file\"\r\n                                        accept=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel\"\r\n                                        @change=\"onFileSelected\">\r\n                                    <br>\r\n                                    <button class=\"btn btn-primary btn-info shadow-none\" type=\"button\" @click=\"clearAll\">\r\n                                        <i class=\"fa fa-remove\">\r\n                                        </i>&nbsp;清除\r\n                                    </button>\r\n                                    <button class=\"btn btn-primary shadow-none\" type=\"button\" @click=\"upload\">\r\n                                    <i class=\"fa fa-upload\">\r\n                                    </i>\r\n                                        &nbsp;上傳\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <AlertBlock :message=\"message\" @closeBlock=\"message=``\" />\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\n    import { getPermissionLevel } from \"@/assets/js/helper.js\"\r\n    import { importUser } from \"@/assets/js/helper.js\"\r\n    import { useRouter } from \"vue-router\"\r\n    import { onMounted } from \"vue\"\r\n    import { ref } from \"vue\"\r\n\r\n    const router = useRouter()\r\n    const message = ref(\"\")\r\n    const fileList = ref(null)\r\n\r\n    onMounted(async () => {\r\n        message.value = \"Warning: You are using admin tool, be careful for those function.\"\r\n\r\n        if (await getPermissionLevel() != 3) {\r\n            message.value = \"YOU SHALL NOT PASS\"\r\n            router.replace(\"/dashboard\")\r\n            console.log(\":<\")\r\n            return\r\n        }\r\n    })\r\n\r\n    function onFileSelected(event) {\r\n        const files = event.target.files[0]\r\n        fileList.value = files\r\n    }\r\n\r\n    async function upload() {\r\n        if (!fileList.value) {\r\n            message.value = \"沒有檔案\"\r\n            return\r\n        }\r\n        const status = await importUser(fileList.value)\r\n        if (status[\"status_code\"] != 200) {\r\n            message.value = \"Error: \" + status[\"status_code\"] + \" \" + status[\"message\"]\r\n            return\r\n        }\r\n        message.value = \"導入成功\"\r\n    }\r\n\r\n    function clearAll() {\r\n        fileList.value = null\r\n    }\r\n</script>","import script from \"./ImportView.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ImportView.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["router","useRouter","message","ref","fileList","onFileSelected","event","files","target","value","async","upload","status","importUser","clearAll","onMounted","getPermissionLevel","replace","console","log","__exports__"],"sourceRoot":""}