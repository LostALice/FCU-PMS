"use strict";(self["webpackChunkpms"]=self["webpackChunkpms"]||[]).push([[542],{3542:function(l,a,e){e.r(a),e.d(a,{default:function(){return T}});e(8858),e(1318),e(3228),e(560);var s=e(3396),o=e(9242),n=e(3311),u=e(2483),t=e(4870);const c={class:"col mb-3"},i={class:"col-lg"},r={class:"row"},v={class:"col"},d={class:"card shadow my-3"},m=(0,s._)("div",{class:"card-header py-3"},[(0,s._)("p",{class:"text-primary m-0 fw-bold",style:{"font-size":"28px"}},"個人檔案")],-1),_={class:"card-body text-center"},p={class:"row"},f={class:"col"},w=["src"],b={class:"col d-flex align-items-center justify-content-center"},y={class:"w-100"},h=(0,s._)("strong",null,"更改圖片",-1),g=(0,s._)("i",{class:"fa fa-save"},null,-1),x={class:"col-lg"},k={class:"row"},U={class:"col"},H={class:"card shadow my-3"},C=(0,s._)("div",{class:"card-header py-3"},[(0,s._)("p",{class:"text-primary m-0 fw-bold",style:{"font-size":"28px"}},"更改電郵")],-1),V={class:"card-body"},q={class:"mb-3"},z=(0,s._)("label",{class:"form-label"},[(0,s._)("strong",null,"新電郵")],-1),E=(0,s._)("i",{class:"fa fa-save"},null,-1),S={class:"col-lg"},j={class:"row"},B={class:"col"},L={class:"card shadow my-3"},P=(0,s._)("div",{class:"card-header py-3"},[(0,s._)("p",{class:"text-primary m-0 fw-bold",style:{"font-size":"28px"}},"更改密碼")],-1),R=(0,s._)("input",{type:"text",name:"email",value:"...",autocomplete:"username email",style:{display:"none"}},null,-1),A={class:"card-body"},D={class:"mb-3"},F=(0,s._)("label",{class:"form-label"},[(0,s._)("strong",null,"舊密碼")],-1),I={class:"row"},O={class:"col"},W={class:"mb-3"},$=(0,s._)("label",{class:"form-label"},[(0,s._)("strong",null,"新密碼")],-1),G={class:"col"},J={class:"mb-3"},K=(0,s._)("label",{class:"form-label"},[(0,s._)("strong",null,"確認密碼")],-1),M=(0,s._)("i",{class:"fa fa-save"},null,-1);var N={__name:"ProfileView",setup(l){const a=(0,u.tv)(),e=(0,t.iH)(""),N=(0,t.iH)(""),Q=(0,t.iH)(""),T=(0,t.iH)(""),X=(0,t.iH)(""),Y=(0,t.iH)(""),Z=(0,t.iH)(File);async function ll(){void 0!=Z.value?(0,n.yu)(Z.value,Z.value.name):e.value="沒有選取圖片"}function al(l){void 0!=Z.value?(Z.value=l.target.files[0],Z.value&&(N.value=URL.createObjectURL(Z.value))):e.value="沒有選取圖片"}async function el(){if(console.log(Q.value),!Q.value)return void(e.value="Email 為空");if(!Q.value.includes("@"))return void(e.value="Email 格式錯誤");const l=await(0,n.Uk)(Q.value);200==l.status_code?a.push(`/about/${localStorage["nid"]}`):e.value="Server Error"}async function sl(){if(""==X.value)return e.value="新密碼不能為空",X.value="",T.value="",void(Y.value="");if(""==T.value)return e.value="舊密碼不能為空",X.value="",T.value="",void(Y.value="");if(""==Y.value)return e.value="舊密碼不能為空",X.value="",T.value="",void(Y.value="");if(T.value==X.value)return e.value="新密碼不能與舊密碼一致",X.value="",T.value="",void(Y.value="");if(X.value!=Y.value)return e.value="密碼不一致",X.value="",T.value="",void(Y.value="");for(const a of[X.value,Y.value,T.value])if(a.length<8)return e.value="密碼至少8個字元以上",X.value="",T.value="",void(Y.value="");const l=(0,n.Hi)(X.value),s=(0,n.Hi)(T.value),o=await(0,n.eI)(s,l);return 200==o.status_code?(localStorage.clear(),void a.replace("/login")):400==o.status_code?(X.value="",T.value="",Y.value="",void(e.value="密碼不正確")):void 0}return(0,s.bv)((async()=>{N.value=await(0,n.oP)()})),(l,a)=>{const n=(0,s.up)("AlertBlock");return(0,s.wg)(),(0,s.iD)("div",c,[(0,s._)("div",i,[(0,s._)("div",r,[(0,s._)("div",v,[(0,s._)("div",d,[m,(0,s._)("div",_,[(0,s._)("div",p,[(0,s._)("div",f,[(0,s._)("img",{id:"main_image",class:"rounded-circle mb-3 mt-4",width:"160",height:"160",src:N.value},null,8,w)]),(0,s._)("div",b,[(0,s._)("div",y,[h,(0,s._)("input",{onChange:al,class:"form-control shadow-none",type:"file",accept:"image/*"},null,32)])]),(0,s._)("div",{class:"text-end"},[(0,s._)("button",{onClick:ll,class:"btn btn-primary btn-sm shadow-none"},[g,(0,s.Uk)("  儲存 ")])])])])])])])]),(0,s._)("div",x,[(0,s._)("div",k,[(0,s._)("div",U,[(0,s._)("div",H,[C,(0,s._)("div",V,[(0,s._)("form",null,[(0,s._)("div",q,[z,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":a[0]||(a[0]=l=>Q.value=l),class:"form-control shadow-none",type:"email",autocomplete:"current-password",required:""},null,512),[[o.nr,Q.value]])]),(0,s._)("div",{class:"text-end mb-3"},[(0,s._)("button",{onClick:el,class:"btn btn-primary btn-sm shadow-none",type:"submit"},[E,(0,s.Uk)("  儲存 ")])])])])])])])]),(0,s._)("div",S,[(0,s._)("div",j,[(0,s._)("div",B,[(0,s._)("div",L,[P,(0,s._)("form",null,[R,(0,s._)("div",A,[(0,s._)("div",D,[F,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":a[1]||(a[1]=l=>T.value=l),class:"form-control shadow-none",type:"password",autocomplete:"current-password",show:"*",minlength:"8",maxlength:"50",required:""},null,512),[[o.nr,T.value]])]),(0,s._)("div",I,[(0,s._)("div",O,[(0,s._)("div",W,[$,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":a[2]||(a[2]=l=>X.value=l),class:"form-control shadow-none",autocomplete:"new-password",show:"*",type:"password",minlength:"8",maxlength:"50",required:""},null,512),[[o.nr,X.value]])])]),(0,s._)("div",G,[(0,s._)("div",J,[K,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":a[3]||(a[3]=l=>Y.value=l),autocomplete:"confirm-password",class:"form-control shadow-none",show:"*",type:"password",minlength:"8",maxlength:"50",required:""},null,512),[[o.nr,Y.value]])])])]),(0,s._)("div",{class:"text-end mb-3"},[(0,s._)("button",{onClick:sl,class:"btn btn-primary btn-sm shadow-none",type:"submit"},[M,(0,s.Uk)("  儲存 ")])])])])])])])]),(0,s.Wm)(n,{message:e.value,onCloseBlock:a[4]||(a[4]=l=>e.value="")},null,8,["message"])])}}};const Q=N;var T=Q}}]);
//# sourceMappingURL=542.8cbd227c.js.map